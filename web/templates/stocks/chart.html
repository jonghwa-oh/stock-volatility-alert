{% extends "base.html" %}

{% block title %}{{ ticker }} ì°¨íŠ¸ - ì£¼ì‹ ì•Œë¦¼{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- í—¤ë” -->
    <div class="flex items-center gap-4">
        <a href="{{ url_for('stocks.list_stocks') }}"
           class="p-2 hover:bg-slate-800 rounded-lg transition-colors">
            â† 
        </a>
        <div>
            <h1 class="text-2xl font-bold flex items-center gap-2">
                <span>{{ 'ğŸ‡°ğŸ‡·' if stock_info and stock_info.country == 'KR' else 'ğŸ‡ºğŸ‡¸' }}</span>
                {{ stock_info.name if stock_info else ticker }}
            </h1>
            <p class="text-slate-400">{{ ticker }}</p>
        </div>
    </div>
    
    {% if analysis %}
    <!-- ë¶„ì„ ìš”ì•½ -->
    <div class="bg-slate-800 rounded-2xl p-6 border border-slate-700">
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
            <div class="text-center p-4 bg-slate-700/50 rounded-xl">
                <p class="text-sm text-slate-400 mb-1">í˜„ì¬ê°€</p>
                <p class="text-xl font-bold">
                    {% if stock_info and stock_info.country == 'KR' %}
                    {{ "{:,.0f}".format(analysis.current_price) }}ì›
                    {% else %}
                    ${{ "{:,.2f}".format(analysis.current_price) }}
                    {% endif %}
                </p>
            </div>
            <div class="text-center p-4 bg-yellow-500/10 rounded-xl">
                <p class="text-sm text-yellow-400 mb-1">0.5Ïƒ ëª©í‘œ</p>
                <p class="text-xl font-bold text-yellow-400">
                    {% if stock_info and stock_info.country == 'KR' %}
                    {{ "{:,.0f}".format(analysis.target_05x) }}ì›
                    {% else %}
                    ${{ "{:,.2f}".format(analysis.target_05x) }}
                    {% endif %}
                </p>
            </div>
            <div class="text-center p-4 bg-blue-500/10 rounded-xl">
                <p class="text-sm text-blue-400 mb-1">1Ïƒ ëª©í‘œ</p>
                <p class="text-xl font-bold text-blue-400">
                    {% if stock_info and stock_info.country == 'KR' %}
                    {{ "{:,.0f}".format(analysis.target_1x) }}ì›
                    {% else %}
                    ${{ "{:,.2f}".format(analysis.target_1x) }}
                    {% endif %}
                </p>
            </div>
            <div class="text-center p-4 bg-purple-500/10 rounded-xl">
                <p class="text-sm text-purple-400 mb-1">2Ïƒ ëª©í‘œ</p>
                <p class="text-xl font-bold text-purple-400">
                    {% if stock_info and stock_info.country == 'KR' %}
                    {{ "{:,.0f}".format(analysis.target_2x) }}ì›
                    {% else %}
                    ${{ "{:,.2f}".format(analysis.target_2x) }}
                    {% endif %}
                </p>
            </div>
        </div>
        
        <div class="mt-4 pt-4 border-t border-slate-700 flex items-center justify-between text-sm">
            <span class="text-slate-400">ì¼ì¼ ë³€ë™ì„±</span>
            <span class="font-medium">{{ "{:.2f}".format(analysis.std_return) }}%</span>
        </div>
    </div>
    {% endif %}
    
    <!-- ì°¨íŠ¸ ì´ë¯¸ì§€ -->
    {% if chart_files %}
    <div x-data="{ selectedChart: '{{ chart_files[0] }}' }" class="space-y-4">
        <!-- ë©”ì¸ ì°¨íŠ¸ (ì„ íƒëœ ì°¨íŠ¸) -->
        <div class="bg-slate-800 rounded-2xl p-4 border border-slate-700">
            <h2 class="text-lg font-bold mb-4">ğŸ“ˆ ë³€ë™ì„± ì°¨íŠ¸</h2>
            
            <div class="bg-slate-900 rounded-xl overflow-hidden">
                <img :src="'/charts/' + selectedChart" 
                     alt="{{ ticker }} ì°¨íŠ¸"
                     class="w-full">
                <p class="text-center text-sm text-slate-400 py-2" x-text="selectedChart.split('/')[1].split('_')[0]"></p>
            </div>
        </div>
        
        <!-- ì°¨íŠ¸ íˆìŠ¤í† ë¦¬ (ì—¬ëŸ¬ê°œì¸ ê²½ìš°ë§Œ) -->
        {% if chart_files|length > 1 %}
        <div class="bg-slate-800 rounded-2xl p-4 border border-slate-700">
            <h3 class="text-sm font-medium text-slate-400 mb-3">ğŸ“… ì´ì „ ì°¨íŠ¸</h3>
            
            <div class="space-y-2">
                {% for chart in chart_files %}
                <button @click="selectedChart = '{{ chart }}'"
                        class="w-full flex items-center justify-between p-3 rounded-xl transition-colors"
                        :class="selectedChart === '{{ chart }}' ? 'bg-blue-600/20 border border-blue-500/50' : 'bg-slate-700/50 hover:bg-slate-700'">
                    <div class="flex items-center gap-3">
                        <span class="text-lg">ğŸ“Š</span>
                        <span>{{ chart.split('/')[-1].split('_')[0] }}</span>
                    </div>
                    <span x-show="selectedChart === '{{ chart }}'" class="text-blue-400">âœ“</span>
                </button>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    {% else %}
    <div class="text-center py-16 bg-slate-800 rounded-2xl border border-slate-700">
        <div class="text-6xl mb-4">ğŸ“Š</div>
        <h2 class="text-xl font-bold mb-2">ì°¨íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</h2>
        <p class="text-slate-400">ì•„ì¹¨ ë¶„ì„ ì‹œ ì°¨íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤</p>
    </div>
    {% endif %}
</div>
{% endblock %}

